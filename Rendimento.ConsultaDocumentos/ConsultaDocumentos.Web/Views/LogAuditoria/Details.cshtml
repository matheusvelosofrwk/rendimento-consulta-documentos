@model ConsultaDocumentos.Web.Models.LogAuditoriaViewModel

@{
    ViewData["Title"] = "Detalhes do Log de Auditoria";
}

<h1>Detalhes do Log de Auditoria</h1>

@if (TempData["Error"] != null)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        @TempData["Error"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

<div class="card">
    <div class="card-header">
        <h5>Informações Gerais</h5>
    </div>
    <div class="card-body">
        <dl class="row">
            <dt class="col-sm-3">ID</dt>
            <dd class="col-sm-9">@Model.Id</dd>

            <dt class="col-sm-3">Data/Hora da Consulta</dt>
            <dd class="col-sm-9">@Model.DataHoraConsulta.ToString("dd/MM/yyyy HH:mm:ss")</dd>

            <dt class="col-sm-3">Aplicação</dt>
            <dd class="col-sm-9">@Model.NomeAplicacao</dd>

            <dt class="col-sm-3">Documento</dt>
            <dd class="col-sm-9">@Model.DocumentoNumero (@Model.TipoDocumento)</dd>

            <dt class="col-sm-3">Sucesso</dt>
            <dd class="col-sm-9">
                @if (Model.ConsultaSucesso)
                {
                    <span class="badge bg-success">Sucesso</span>
                }
                else
                {
                    <span class="badge bg-danger">Falha</span>
                }
            </dd>

            <dt class="col-sm-3">Tempo de Processamento</dt>
            <dd class="col-sm-9">@Model.TempoProcessamentoMs ms</dd>

            <dt class="col-sm-3">Origem</dt>
            <dd class="col-sm-9">
                @if (Model.OrigemCache)
                {
                    <span class="badge bg-info">Cache</span>
                }
                else
                {
                    <span class="badge bg-secondary">API</span>
                }
            </dd>

            <dt class="col-sm-3">Provedor Principal</dt>
            <dd class="col-sm-9">@(Model.ProvedorPrincipal ?? "-")</dd>

            @if (!string.IsNullOrWhiteSpace(Model.ProvedoresUtilizados))
            {
                <dt class="col-sm-3">Provedores Utilizados</dt>
                <dd class="col-sm-9">
                    <pre class="bg-light p-2">@Model.ProvedoresUtilizados</pre>
                </dd>
            }

            @if (!string.IsNullOrWhiteSpace(Model.MensagemRetorno))
            {
                <dt class="col-sm-3">Mensagem</dt>
                <dd class="col-sm-9">@Model.MensagemRetorno</dd>
            }
        </dl>
    </div>
</div>

@if (!string.IsNullOrWhiteSpace(Model.ParametrosEntrada))
{
    <div class="card mt-3">
        <div class="card-header">
            <h5>Parâmetros de Entrada</h5>
        </div>
        <div class="card-body">
            <pre class="bg-light p-3">@Model.ParametrosEntrada</pre>
        </div>
    </div>
}

@if (!string.IsNullOrWhiteSpace(Model.RespostaProvedor))
{
    <div class="card mt-3">
        <div class="card-header">
            <h5>Resposta do Provedor</h5>
        </div>
        <div class="card-body">
            <pre class="bg-light p-3" style="max-height: 400px; overflow-y: auto;">@Model.RespostaProvedor</pre>
        </div>
    </div>
}

<div class="card mt-3">
    <div class="card-header">
        <h5>Informações Técnicas</h5>
    </div>
    <div class="card-body">
        <dl class="row">
            <dt class="col-sm-3">Endereço IP</dt>
            <dd class="col-sm-9">@(Model.EnderecoIp ?? "-")</dd>

            <dt class="col-sm-3">User Agent</dt>
            <dd class="col-sm-9">@(Model.UserAgent ?? "-")</dd>

            @if (!string.IsNullOrWhiteSpace(Model.InformacoesAdicionais))
            {
                <dt class="col-sm-3">Informações Adicionais</dt>
                <dd class="col-sm-9">
                    <pre class="bg-light p-2">@Model.InformacoesAdicionais</pre>
                </dd>
            }
        </dl>
    </div>
</div>

<div class="mt-3">
    <a asp-action="Index" class="btn btn-secondary">Voltar para Lista</a>
</div>
