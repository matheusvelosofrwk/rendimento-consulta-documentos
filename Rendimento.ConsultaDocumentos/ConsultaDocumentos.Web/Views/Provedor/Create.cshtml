@model ConsultaDocumentos.Web.Models.ProvedorViewModel

@{
    ViewData["Title"] = "Novo Provedor";
}

<!-- Page Header -->
<div class="page-header fade-in">
    <div class="d-flex justify-content-between align-items-center">
        <div>
            <h1><i class="fas fa-plus-circle"></i> Novo Provedor</h1>
            <p>Cadastre um novo provedor de consulta de documentos</p>
        </div>
        <div>
            <a asp-action="Index" class="btn btn-secondary btn-icon">
                <i class="fas fa-arrow-left"></i>
                <span>Voltar</span>
            </a>
        </div>
    </div>
</div>

<!-- Form Card -->
<div class="row justify-content-center fade-in">
    <div class="col-lg-10">
        <div class="card-modern">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-info-circle"></i> Dados do Provedor
                </h5>
            </div>
            <div class="card-body" style="padding: 2rem;">
                <form asp-action="Create" method="post" class="form-modern">
                    <div asp-validation-summary="ModelOnly" class="alert alert-modern alert-danger mb-4"></div>

                    <!-- Seção: Informações Básicas -->
                    <h6 class="text-primary mb-3"><i class="fas fa-server me-2"></i>Informações Básicas</h6>

                    <div class="row">
                        <div class="col-md-6">
                            <!-- Nome -->
                            <div class="form-group mb-4">
                                <label asp-for="Nome" class="form-label">
                                    <i class="fas fa-tag text-primary me-2"></i>Nome do Provedor
                                </label>
                                <div class="input-group input-group-modern">
                                    <span class="input-group-text">
                                        <i class="fas fa-server"></i>
                                    </span>
                                    <input asp-for="Nome" class="form-control" placeholder="Ex: SERPRO, Serasa, BoaVista" />
                                </div>
                                <span asp-validation-for="Nome" class="text-danger small"></span>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <!-- Descrição -->
                            <div class="form-group mb-4">
                                <label asp-for="Descricao" class="form-label">
                                    <i class="fas fa-info-circle text-primary me-2"></i>Descrição
                                </label>
                                <div class="input-group input-group-modern">
                                    <span class="input-group-text">
                                        <i class="fas fa-align-left"></i>
                                    </span>
                                    <input asp-for="Descricao" class="form-control" placeholder="Breve descrição do provedor" />
                                </div>
                                <span asp-validation-for="Descricao" class="text-danger small"></span>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <!-- EndpointUrl -->
                            <div class="form-group mb-4">
                                <label asp-for="EndpointUrl" class="form-label">
                                    <i class="fas fa-link text-primary me-2"></i>Endpoint URL
                                </label>
                                <div class="input-group input-group-modern">
                                    <span class="input-group-text">
                                        <i class="fas fa-globe"></i>
                                    </span>
                                    <input asp-for="EndpointUrl" class="form-control" placeholder="https://api.provedor.com.br" />
                                </div>
                                <span asp-validation-for="EndpointUrl" class="text-danger small"></span>
                            </div>
                        </div>

                        <div class="col-md-3">
                            <!-- Prioridade -->
                            <div class="form-group mb-4">
                                <label asp-for="Prioridade" class="form-label">
                                    <i class="fas fa-sort-amount-up text-primary me-2"></i>Prioridade
                                </label>
                                <div class="input-group input-group-modern">
                                    <span class="input-group-text">
                                        <i class="fas fa-hashtag"></i>
                                    </span>
                                    <input asp-for="Prioridade" type="number" class="form-control" placeholder="1" />
                                </div>
                                <span asp-validation-for="Prioridade" class="text-danger small"></span>
                            </div>
                        </div>

                        <div class="col-md-3">
                            <!-- Timeout -->
                            <div class="form-group mb-4">
                                <label asp-for="Timeout" class="form-label">
                                    <i class="fas fa-clock text-primary me-2"></i>Timeout (ms)
                                </label>
                                <div class="input-group input-group-modern">
                                    <span class="input-group-text">
                                        <i class="fas fa-stopwatch"></i>
                                    </span>
                                    <input asp-for="Timeout" type="number" class="form-control" placeholder="30000" />
                                </div>
                                <span asp-validation-for="Timeout" class="text-danger small"></span>
                            </div>
                        </div>
                    </div>

                    <div class="divider my-4"></div>

                    <!-- Seção: Autenticação -->
                    <h6 class="text-primary mb-3"><i class="fas fa-key me-2"></i>Configurações de Autenticação</h6>

                    <div class="row">
                        <div class="col-md-12">
                            <!-- Credencial -->
                            <div class="form-group mb-4">
                                <label asp-for="Credencial" class="form-label">
                                    <i class="fas fa-key text-primary me-2"></i>Credencial / API Key
                                </label>
                                <div class="input-group input-group-modern">
                                    <span class="input-group-text">
                                        <i class="fas fa-lock"></i>
                                    </span>
                                    <input asp-for="Credencial" class="form-control" placeholder="Chave de API ou credencial de acesso" />
                                </div>
                                <span asp-validation-for="Credencial" class="text-danger small"></span>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-12">
                            <!-- EndCertificado -->
                            <div class="form-group mb-4">
                                <label asp-for="EndCertificado" class="form-label">
                                    <i class="fas fa-certificate text-primary me-2"></i>Caminho do Certificado
                                </label>
                                <div class="input-group input-group-modern">
                                    <span class="input-group-text">
                                        <i class="fas fa-file-certificate"></i>
                                    </span>
                                    <input asp-for="EndCertificado" class="form-control" placeholder="C:\Certificates\certificado.pfx" />
                                </div>
                                <span asp-validation-for="EndCertificado" class="text-danger small"></span>
                                <small class="form-text text-muted">
                                    <i class="fas fa-info-circle"></i> Caminho do certificado digital (.pfx) - Usado pelo SERPRO
                                </small>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-4">
                            <!-- Usuario -->
                            <div class="form-group mb-4">
                                <label asp-for="Usuario" class="form-label">
                                    <i class="fas fa-user text-primary me-2"></i>Usuário
                                </label>
                                <div class="input-group input-group-modern">
                                    <span class="input-group-text">
                                        <i class="fas fa-user-circle"></i>
                                    </span>
                                    <input asp-for="Usuario" class="form-control" placeholder="Nome de usuário" />
                                </div>
                                <span asp-validation-for="Usuario" class="text-danger small"></span>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <!-- Senha -->
                            <div class="form-group mb-4">
                                <label asp-for="Senha" class="form-label">
                                    <i class="fas fa-lock text-primary me-2"></i>Senha
                                </label>
                                <div class="input-group input-group-modern">
                                    <span class="input-group-text">
                                        <i class="fas fa-key"></i>
                                    </span>
                                    <input asp-for="Senha" type="password" class="form-control" placeholder="Senha de acesso" />
                                </div>
                                <span asp-validation-for="Senha" class="text-danger small"></span>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <!-- Dominio -->
                            <div class="form-group mb-4">
                                <label asp-for="Dominio" class="form-label">
                                    <i class="fas fa-network-wired text-primary me-2"></i>Domínio
                                </label>
                                <div class="input-group input-group-modern">
                                    <span class="input-group-text">
                                        <i class="fas fa-sitemap"></i>
                                    </span>
                                    <input asp-for="Dominio" class="form-control" placeholder="Domínio de rede" />
                                </div>
                                <span asp-validation-for="Dominio" class="text-danger small"></span>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <!-- Porta -->
                            <div class="form-group mb-4">
                                <label asp-for="Porta" class="form-label">
                                    <i class="fas fa-ethernet text-primary me-2"></i>Porta TCP
                                </label>
                                <div class="input-group input-group-modern">
                                    <span class="input-group-text">
                                        <i class="fas fa-plug"></i>
                                    </span>
                                    <input asp-for="Porta" type="number" class="form-control" placeholder="Ex: 8080" />
                                </div>
                                <span asp-validation-for="Porta" class="text-danger small"></span>
                                <small class="form-text text-muted">
                                    <i class="fas fa-info-circle"></i> Porta TCP (usado pelo BoaVista Socket)
                                </small>
                            </div>
                        </div>
                    </div>

                    <div class="divider my-4"></div>

                    <!-- Seção: Controle de Quota -->
                    <h6 class="text-primary mb-3"><i class="fas fa-chart-line me-2"></i>Controle de Quota</h6>

                    <div class="row">
                        <div class="col-md-6">
                            <!-- QtdAcessoMinimo -->
                            <div class="form-group mb-4">
                                <label asp-for="QtdAcessoMinimo" class="form-label">
                                    <i class="fas fa-arrow-down text-primary me-2"></i>Quantidade Mínima de Acesso
                                </label>
                                <div class="input-group input-group-modern">
                                    <span class="input-group-text">
                                        <i class="fas fa-minus-circle"></i>
                                    </span>
                                    <input asp-for="QtdAcessoMinimo" type="number" class="form-control" placeholder="0" />
                                </div>
                                <span asp-validation-for="QtdAcessoMinimo" class="text-danger small"></span>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <!-- QtdAcessoMaximo -->
                            <div class="form-group mb-4">
                                <label asp-for="QtdAcessoMaximo" class="form-label">
                                    <i class="fas fa-arrow-up text-primary me-2"></i>Quantidade Máxima de Acesso
                                </label>
                                <div class="input-group input-group-modern">
                                    <span class="input-group-text">
                                        <i class="fas fa-plus-circle"></i>
                                    </span>
                                    <input asp-for="QtdAcessoMaximo" type="number" class="form-control" placeholder="10000" />
                                </div>
                                <span asp-validation-for="QtdAcessoMaximo" class="text-danger small"></span>
                                <small class="form-text text-muted">
                                    <i class="fas fa-info-circle"></i> Limite diário de consultas (SERPRO)
                                </small>
                            </div>
                        </div>
                    </div>

                    <div class="divider my-4"></div>

                    <!-- Seção: Validade de Cache -->
                    <h6 class="text-primary mb-3"><i class="fas fa-database me-2"></i>Validade de Cache</h6>

                    <div class="row">
                        <div class="col-md-4">
                            <!-- QtdDiasValidadePF -->
                            <div class="form-group mb-4">
                                <label asp-for="QtdDiasValidadePF" class="form-label">
                                    <i class="fas fa-user text-primary me-2"></i>Dias de Validade PF
                                </label>
                                <div class="input-group input-group-modern">
                                    <span class="input-group-text">
                                        <i class="fas fa-calendar-day"></i>
                                    </span>
                                    <input asp-for="QtdDiasValidadePF" type="number" class="form-control" min="1" max="365" placeholder="30" />
                                </div>
                                <span asp-validation-for="QtdDiasValidadePF" class="text-danger small"></span>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <!-- QtdDiasValidadePJ -->
                            <div class="form-group mb-4">
                                <label asp-for="QtdDiasValidadePJ" class="form-label">
                                    <i class="fas fa-building text-primary me-2"></i>Dias de Validade PJ
                                </label>
                                <div class="input-group input-group-modern">
                                    <span class="input-group-text">
                                        <i class="fas fa-calendar-day"></i>
                                    </span>
                                    <input asp-for="QtdDiasValidadePJ" type="number" class="form-control" min="1" max="365" placeholder="30" />
                                </div>
                                <span asp-validation-for="QtdDiasValidadePJ" class="text-danger small"></span>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <!-- QtdDiasValidadeEND -->
                            <div class="form-group mb-4">
                                <label asp-for="QtdDiasValidadeEND" class="form-label">
                                    <i class="fas fa-map-marker-alt text-primary me-2"></i>Dias de Validade END
                                </label>
                                <div class="input-group input-group-modern">
                                    <span class="input-group-text">
                                        <i class="fas fa-calendar-day"></i>
                                    </span>
                                    <input asp-for="QtdDiasValidadeEND" type="number" class="form-control" min="1" max="365" placeholder="30" />
                                </div>
                                <span asp-validation-for="QtdDiasValidadeEND" class="text-danger small"></span>
                            </div>
                        </div>
                    </div>

                    <div class="divider my-4"></div>

                    <!-- Seção: Alertas e Faturamento -->
                    <h6 class="text-primary mb-3"><i class="fas fa-bell me-2"></i>Alertas e Faturamento</h6>

                    <div class="row">
                        <div class="col-md-6">
                            <!-- QtdMinEmailLog -->
                            <div class="form-group mb-4">
                                <label asp-for="QtdMinEmailLog" class="form-label">
                                    <i class="fas fa-envelope text-primary me-2"></i>Mínimo de Erros para Email
                                </label>
                                <div class="input-group input-group-modern">
                                    <span class="input-group-text">
                                        <i class="fas fa-exclamation-triangle"></i>
                                    </span>
                                    <input asp-for="QtdMinEmailLog" type="number" class="form-control" placeholder="10" />
                                </div>
                                <span asp-validation-for="QtdMinEmailLog" class="text-danger small"></span>
                                <small class="form-text text-muted">
                                    <i class="fas fa-info-circle"></i> Quantidade mínima de erros para enviar alerta por email
                                </small>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <!-- DiaCorte -->
                            <div class="form-group mb-4">
                                <label asp-for="DiaCorte" class="form-label">
                                    <i class="fas fa-calendar-check text-primary me-2"></i>Dia de Corte
                                </label>
                                <div class="input-group input-group-modern">
                                    <span class="input-group-text">
                                        <i class="fas fa-calendar"></i>
                                    </span>
                                    <input asp-for="DiaCorte" type="number" class="form-control" min="1" max="31" placeholder="1" />
                                </div>
                                <span asp-validation-for="DiaCorte" class="text-danger small"></span>
                                <small class="form-text text-muted">
                                    <i class="fas fa-info-circle"></i> Dia de corte para faturamento mensal
                                </small>
                            </div>
                        </div>
                    </div>

                    <div class="divider my-4"></div>

                    <!-- Seção: Tipo de Documento e Status -->
                    <h6 class="text-primary mb-3"><i class="fas fa-file-alt me-2"></i>Tipo de Documento e Status</h6>

                    <div class="row">
                        <div class="col-md-6">
                            <!-- TipoWebService -->
                            <div class="form-group mb-4">
                                <label asp-for="TipoWebService" class="form-label">
                                    <i class="fas fa-list-alt text-primary me-2"></i>Tipo de Documento
                                </label>
                                <div class="input-group input-group-modern">
                                    <span class="input-group-text">
                                        <i class="fas fa-id-card"></i>
                                    </span>
                                    <select asp-for="TipoWebService" class="form-control">
                                        <option value="1">CPF</option>
                                        <option value="2">CNPJ</option>
                                        <option value="3" selected>Ambos (CPF e CNPJ)</option>
                                    </select>
                                </div>
                                <span asp-validation-for="TipoWebService" class="text-danger small"></span>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <!-- Status -->
                            <div class="form-group mb-4">
                                <label asp-for="Status" class="form-label">
                                    <i class="fas fa-toggle-on text-primary me-2"></i>Status
                                </label>
                                <div class="input-group input-group-modern">
                                    <span class="input-group-text">
                                        <i class="fas fa-check-circle"></i>
                                    </span>
                                    <input asp-for="Status" class="form-control" placeholder="Ativo" />
                                </div>
                                <span asp-validation-for="Status" class="text-danger small"></span>
                            </div>
                        </div>
                    </div>

                    <div class="divider my-4"></div>

                    <!-- Botões de Ação -->
                    <div class="d-flex gap-3 justify-content-end">
                        <a asp-action="Index" class="btn btn-secondary btn-modern btn-icon">
                            <i class="fas fa-times"></i>
                            <span>Cancelar</span>
                        </a>
                        <button type="submit" class="btn btn-primary-modern btn-modern btn-icon">
                            <i class="fas fa-save"></i>
                            <span>Salvar Provedor</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Informações Adicionais -->
        <div class="alert alert-modern alert-info mt-4">
            <i class="fas fa-lightbulb me-2"></i>
            <strong>Dica:</strong> Preencha apenas os campos necessários para o tipo de provedor que você está configurando. Campos vazios serão ignorados.
        </div>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    <script>
        $(document).ready(function() {
            // Focar no primeiro campo
            $('input[name="Nome"]').focus();

            // Animação ao submeter
            $('form').on('submit', function() {
                if ($(this).valid()) {
                    showLoading();
                }
            });
        });
    </script>
}
